---
title: 虚拟机通过代理上外网
date: 2018-03-24 15:06:40
tags: openstack
categories: openstack
---

## 虚拟机通过代理连接外网

1. 因为实验室的服务器没有连接外网，而如果又需要连网的需求，那么可以通过代理的方式，有一款软件CCProxy，需要有校园IP ，服务器的ip网段172.21.4.x，校园网的ip网段为172.21.6.x， 所以虚拟机可以通过有校园网IP的电脑作为Proxy。
2. 下载CCproxy，主界面如下，点击账号管理。
![image](https://github.com/sjt157/MarkDownPhotos/raw/master/CCProxy/1.png)
3. 新建一个用户
![image](https://github.com/sjt157/MarkDownPhotos/raw/master/CCProxy/2.png)
4. 注意：输入用户名，勾选密码，自定义一个密码，取消勾选IP地址/IP地址段
![image](https://github.com/sjt157/MarkDownPhotos/raw/master/CCProxy/3.png)
5. 回到主界面，点击设置，按如下方式设置，注意“请选择本机局域网IP地址默认为自动检测，如果虚拟机不能联网，可尝试手动修改其为本机当前IP地址”
![image](https://github.com/sjt157/MarkDownPhotos/raw/master/CCProxy/4.png)
6. 在虚拟机中输入如下命令：
   `export http_proxy=http://username:passwd@ip:port`
7. 之后就可以使用apt-get 等功能安装软件包，升级系统。**注意**：代理设置只在当前ssh连接有效，如果你断开过ssh连接，重新连接后，需要重新在ubuntu中通过命令设置代理。

